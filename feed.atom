<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title type="text">vBlog</title>
  <id>/feed.atom</id>
  <updated>2013-08-17T21:11:00Z</updated>
  <link href="/feed.atom" rel="self" />
  <author>
    <name>Vlad Vasiliu</name>
  </author>
  <generator>PyAtom</generator>
  <entry xml:base="/feed.atom">
    <title type="text">Setting default NFSv4 ACLs on FreeBSD</title>
    <id>/post/2013-08-17_03-setting_default_nfsv4_acls_on_freebsd.html</id>
    <updated>2013-08-17T21:11:00Z</updated>
    <link href="/post/2013-08-17_03-setting_default_nfsv4_acls_on_freebsd.html" />
    <author>
      <name>Vlad Vasiliu</name>
    </author>
    <content type="html">&lt;p&gt;On FreeBSD with ZFS, only NFSv4 ACLs are supported. At the time of this writing, the &lt;a href="https://wiki.freebsd.org/NFSv4_ACLs"&gt;FreeBSD documentation regarding ACLs&lt;/a&gt; is a bit vague. Specifically, it doesn’t talk about inheritable attributes.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;-d&lt;/code&gt; argument, used to define default POSIX ACLs is not supported. Instead, there are some flags one can set in order to define how ACLs are inherited. For an explanation, look in the manual for &lt;code&gt;setfacl&lt;/code&gt;, section &lt;em&gt;ACL inheritance flags&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Let’s say you want all the files and directories inside &lt;code&gt;somedir&lt;/code&gt; to be readable by the users in the group &lt;code&gt;somegroup&lt;/code&gt;. You would do the following:&lt;/p&gt;

            &lt;div class="highlight"&gt;
              &lt;pre&gt;&lt;code&gt;setfacl -m g:somegroup:rx:fd:allow somedir&lt;/code&gt;&lt;/pre&gt;
            &lt;/div&gt;
            
&lt;p&gt;This sets &lt;code&gt;somedir&lt;/code&gt; to be readable and executable by &lt;code&gt;somegroup&lt;/code&gt; and those properties will be inherited by all new files (the &lt;code&gt;f&lt;/code&gt; flag) and directories (&lt;code&gt;d&lt;/code&gt; flag).&lt;/p&gt;

&lt;p&gt;Note, however, that this only applies to newly created files. In the FreeBSD implementation of &lt;code&gt;setfacl&lt;/code&gt; there is no recursive option. One way of applying the changes to the subtree is:&lt;/p&gt;

            &lt;div class="highlight"&gt;
              &lt;pre&gt;&lt;code&gt;find . -type d -exec setfacl -m g:somegroup:rx:fd:allow {} \;
find . -type f -exec setfacl -m g:somegroup:r::allow {} \;&lt;/code&gt;&lt;/pre&gt;
            &lt;/div&gt;
            
&lt;p&gt;The first line sets the previous ACLs on all the subdirectories, while the second sets the ACL on all the files.&lt;/p&gt;

&lt;p&gt;In order for this to work, some ZFS attributes must be set: &lt;code&gt;aclinherit=passthrough-x&lt;/code&gt; and &lt;code&gt;aclmode=passthrough&lt;/code&gt;.
See &lt;a href="http://docs.oracle.com/cd/E19082-01/817-2271/gbaaz/index.html"&gt;here&lt;/a&gt; for the ZFS properties documentation.&lt;/p&gt;
</content>
  </entry>
  <entry xml:base="/feed.atom">
    <title type="text">MySQL Replication - I/O Error Code 1045</title>
    <id>/post/2013-08-17_02-mysql_replication_io_error_code_1045.html</id>
    <updated>2013-08-17T21:05:00Z</updated>
    <link href="/post/2013-08-17_02-mysql_replication_io_error_code_1045.html" />
    <author>
      <name>Vlad Vasiliu</name>
    </author>
    <content type="html">&lt;p&gt;Setting up replication on MySQL may yield the following error:&lt;/p&gt;

            &lt;div class="highlight"&gt;
              &lt;pre&gt;&lt;code&gt;[ERROR] Slave I/O: error connecting to master, Error code 1045&lt;/code&gt;&lt;/pre&gt;
            &lt;/div&gt;
            
&lt;p&gt;The MySQL troubleshooting page gives a few hints, talking about credentials for the replication user. However, attempting a connection via the command line client works, so the password is OK and the slave can reach the master. As it turns out, for replication purposes, the maximum password length is 32 characters.&lt;/p&gt;
</content>
  </entry>
  <entry xml:base="/feed.atom">
    <title type="text">Hello world!</title>
    <id>/post/2013-08-17_01-hello-world.html</id>
    <updated>2013-08-17T20:52:00Z</updated>
    <link href="/post/2013-08-17_01-hello-world.html" />
    <author>
      <name>Vlad Vasiliu</name>
    </author>
    <content type="html">&lt;p&gt;This is a static site. It is generated by &lt;a href="http://lilac.hit9.org/"&gt;lilac&lt;/a&gt; and hosted on &lt;a href="http://pages.github.com/"&gt;GitHub Pages&lt;/a&gt;.&lt;/p&gt;
</content>
  </entry>
</feed>
